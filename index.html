<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferienangebote Anbieter Berlin</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.5;
            color: #0f172a;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 16px;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
            padding: 24px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 16px;
            font-weight: 400;
        }

        .stats {
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        .filters {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            position: sticky;
            top: 20px;
            z-index: 10;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
        }

        .filter-group select, 
        .filter-group input {
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.875rem;
            background: white;
            transition: all 0.2s;
            font-family: inherit;
        }

        .filter-group select:focus, 
        .filter-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .clear-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 0.875rem;
            color: white;
            font-weight: 600;
            transition: all 0.2s;
            font-family: inherit;
        }

        .clear-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(217, 119, 6, 0.3);
        }

        .results-info {
            margin-bottom: 16px;
            padding: 12px 16px;
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-radius: 8px;
            font-size: 0.875rem;
            color: #1e40af;
            font-weight: 500;
            border-left: 4px solid #3b82f6;
        }

        .providers-list {
            display: grid;
            gap: 16px;
        }

        .provider-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s;
            border: 1px solid #f3f4f6;
        }

        .provider-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .provider-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .provider-category {
            display: inline-block;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .provider-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .detail-item {
            font-size: 0.875rem;
            background: #f8fafc;
            padding: 8px 12px;
            border-radius: 6px;
        }

        .detail-label {
            font-weight: 600;
            color: #64748b;
            display: block;
            margin-bottom: 2px;
        }

        .detail-value {
            color: #1e293b;
            font-weight: 500;
        }

        .provider-website {
            margin-top: 16px;
        }

        .website-link {
            color: #3b82f6;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .website-link:hover {
            color: #1d4ed8;
            transform: translateX(2px);
        }

        .website-link:before {
            content: "üåê";
        }

        .provider-notes {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 4px solid #f59e0b;
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
            font-size: 0.875rem;
            color: #92400e;
            font-weight: 500;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .container {
                padding: 16px 12px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .header {
                padding: 20px;
            }
            
            .filter-row {
                grid-template-columns: 1fr;
            }
            
            .filters {
                position: static;
            }
            
            .provider-details {
                grid-template-columns: 1fr;
            }
            
            .provider-item {
                padding: 16px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.75rem;
            }
            
            .subtitle {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Ferienangebote Anbieter Berlin</h1>
            <p class="subtitle">√úbersicht aller Anbieter von Ferienangeboten f√ºr Kinder und Jugendliche in Berlin</p>
            <div class="stats" id="statsInfo">Lade Daten...</div>
        </div>

        <div class="filters">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="categoryFilter">Kategorie</label>
                    <select id="categoryFilter">
                        <option value="">Alle Kategorien</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="districtFilter">Bezirk/Standort</label>
                    <select id="districtFilter">
                        <option value="">Alle Bezirke</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="ageFilter">Zielgruppe</label>
                    <select id="ageFilter">
                        <option value="">Alle Altersgruppen</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="searchFilter">Suche</label>
                    <input type="text" id="searchFilter" placeholder="Anbieter suchen...">
                </div>
                <button class="clear-btn" onclick="clearAllFilters()">Zur√ºcksetzen</button>
            </div>
        </div>

        <div class="results-info" id="resultsInfo">
            Lade Anbieter...
        </div>

        <div class="providers-list" id="providersList">
            <div class="loading">Lade Anbieter...</div>
        </div>
    </div>

    <script>
        let allProviders = [];
        let filteredProviders = [];

        // Configuration - GitHub raw CSV URL
        const CSV_URL = 'https://raw.githubusercontent.com/jakobschumacher/ferienangebote_fuer_kinder/refs/heads/main/anbieter.csv';

        // Load CSV data dynamically
        async function loadCSVData() {
            try {
                document.getElementById('resultsInfo').textContent = 'Lade Daten...';
                
                const response = await fetch(CSV_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const csvText = await response.text();
                parseCSVData(csvText);
                
            } catch (error) {
                console.error('Fehler beim Laden der CSV-Daten:', error);
                document.getElementById('resultsInfo').innerHTML = 
                    `<span style="color: #d73a49;">Fehler beim Laden der Daten: ${error.message}</span>`;
                document.getElementById('providersList').innerHTML = 
                    '<div class="no-results">Die Daten konnten nicht geladen werden. Bitte versuchen Sie es sp√§ter erneut.</div>';
            }
        }

        // Simple CSV parser
        function parseCSVData(csvText) {
            const lines = csvText.split('\n').filter(line => line.trim());
            const headers = parseCSVLine(lines[0]);
            
            allProviders = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = parseCSVLine(lines[i]);
                if (values.length >= headers.length) {
                    const provider = {};
                    headers.forEach((header, index) => {
                        provider[header] = values[index] || '';
                    });
                    allProviders.push(provider);
                }
            }
            
            initializeFilters();
            filterProviders();
            updateStats();
        }

        // Parse a single CSV line handling quoted fields
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    if (inQuotes && line[i + 1] === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current.trim());
            return result;
        }

        // Initialize filter dropdowns
        function initializeFilters() {
            const categories = [...new Set(allProviders.map(p => p['Tr√§ger-Kategorie']))].sort();
            const districts = [...new Set(allProviders.map(p => p['Bezirk/Standort']))].sort();
            const ageGroups = [...new Set(allProviders.map(p => p['Zielgruppe']))].sort();

            populateSelect('categoryFilter', categories);
            populateSelect('districtFilter', districts);
            populateSelect('ageFilter', ageGroups);
        }

        function populateSelect(selectId, options) {
            const select = document.getElementById(selectId);
            const currentValue = select.value;
            
            // Keep the "All" option and add new options
            select.innerHTML = select.children[0].outerHTML;
            
            options.forEach(option => {
                if (option && option.trim()) {
                    const optionElement = document.createElement('option');
                    optionElement.value = option;
                    optionElement.textContent = option;
                    select.appendChild(optionElement);
                }
            });
            
            select.value = currentValue;
        }

        // Filter providers based on current filter values
        function filterProviders() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            const districtFilter = document.getElementById('districtFilter').value;
            const ageFilter = document.getElementById('ageFilter').value;
            const searchFilter = document.getElementById('searchFilter').value.toLowerCase();

            filteredProviders = allProviders.filter(provider => {
                const matchesCategory = !categoryFilter || provider['Tr√§ger-Kategorie'] === categoryFilter;
                const matchesDistrict = !districtFilter || provider['Bezirk/Standort'] === districtFilter;
                const matchesAge = !ageFilter || provider['Zielgruppe'] === ageFilter;
                const matchesSearch = !searchFilter || 
                    provider.Anbieter.toLowerCase().includes(searchFilter) ||
                    provider['Angebots-Typ'].toLowerCase().includes(searchFilter) ||
                    provider.Anmerkungen.toLowerCase().includes(searchFilter) ||
                    provider['Tr√§ger-Kategorie'].toLowerCase().includes(searchFilter);

                return matchesCategory && matchesDistrict && matchesAge && matchesSearch;
            });

            displayProviders();
            updateResultsInfo();
        }

        // Display filtered providers
        function displayProviders() {
            const list = document.getElementById('providersList');
            
            if (filteredProviders.length === 0) {
                list.innerHTML = '<div class="no-results">Keine Anbieter gefunden. Versuchen Sie andere Filtereinstellungen.</div>';
                return;
            }

            list.innerHTML = filteredProviders.map(provider => {
                const websiteDisplay = provider['Website/Kontakt'] && provider['Website/Kontakt'] !== '-' 
                    ? `<div class="provider-website">
                         <a href="https://${provider['Website/Kontakt'].replace(/^https?:\/\//, '')}" 
                            target="_blank" 
                            class="website-link">
                            ‚Üí ${provider['Website/Kontakt']}
                         </a>
                       </div>`
                    : '';

                const notesDisplay = provider.Anmerkungen && provider.Anmerkungen !== '-'
                    ? `<div class="provider-notes">
                         ${provider.Anmerkungen}
                       </div>`
                    : '';

                return `
                    <div class="provider-item">
                        <div class="provider-name">${provider.Anbieter}</div>
                        <div class="provider-category">${provider['Tr√§ger-Kategorie']}</div>
                        
                        <div class="provider-details">
                            <div class="detail-item">
                                <span class="detail-label">Standort:</span>
                                <span class="detail-value">${provider['Bezirk/Standort']}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Zielgruppe:</span>
                                <span class="detail-value">${provider.Zielgruppe}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Angebots-Typ:</span>
                                <span class="detail-value">${provider['Angebots-Typ']}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Kosten:</span>
                                <span class="detail-value">${provider.Kosten}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Tr√§gerschaft:</span>
                                <span class="detail-value">${provider.Tr√§gerschaft}</span>
                            </div>
                        </div>
                        
                        ${websiteDisplay}
                        ${notesDisplay}
                    </div>
                `;
            }).join('');
        }

        // Update results info
        function updateResultsInfo() {
            const info = document.getElementById('resultsInfo');
            if (filteredProviders.length === allProviders.length) {
                info.textContent = `${allProviders.length} Anbieter insgesamt`;
            } else {
                info.textContent = `${filteredProviders.length} von ${allProviders.length} Anbietern gefunden`;
            }
        }

        // Update statistics
        function updateStats() {
            const categories = new Set(allProviders.map(p => p['Tr√§ger-Kategorie']));
            const districts = new Set(allProviders.map(p => p['Bezirk/Standort']));
            
            document.getElementById('statsInfo').textContent = 
                `${allProviders.length} Anbieter ‚Ä¢ ${categories.size} Kategorien ‚Ä¢ ${districts.size} Standorte`;
        }

        // Clear all filters
        function clearAllFilters() {
            document.getElementById('categoryFilter').value = '';
            document.getElementById('districtFilter').value = '';
            document.getElementById('ageFilter').value = '';
            document.getElementById('searchFilter').value = '';
            filterProviders();
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listeners for filters
            document.getElementById('categoryFilter').addEventListener('change', filterProviders);
            document.getElementById('districtFilter').addEventListener('change', filterProviders);
            document.getElementById('ageFilter').addEventListener('change', filterProviders);
            document.getElementById('searchFilter').addEventListener('input', filterProviders);

            // Load initial data
            loadCSVData();
        });
    </script>
</body>
</html>
